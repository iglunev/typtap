(function(){'use strict';function g(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function l(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):{next:g(a)}}var n="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this,p="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,d){a!=Array.prototype&&a!=Object.prototype&&(a[b]=d.value)};
function q(a,b){if(b){var d=n;a=a.split(".");for(var c=0;c<a.length-1;c++){var e=a[c];e in d||(d[e]={});d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&null!=b&&p(d,a,{configurable:!0,writable:!0,value:b})}}
q("Promise",function(a){function b(b){this.b=0;this.h=void 0;this.a=[];var a=this.c();try{b(a.resolve,a.reject)}catch(k){a.reject(k)}}function d(){this.a=null}function c(a){return a instanceof b?a:new b(function(b){b(a)})}if(a)return a;d.prototype.b=function(b){if(null==this.a){this.a=[];var a=this;this.c(function(){a.h()})}this.a.push(b)};var e=n.setTimeout;d.prototype.c=function(b){e(b,0)};d.prototype.h=function(){for(;this.a&&this.a.length;){var b=this.a;this.a=[];for(var a=0;a<b.length;++a){var c=
b[a];b[a]=null;try{c()}catch(m){this.f(m)}}}this.a=null};d.prototype.f=function(b){this.c(function(){throw b;})};b.prototype.c=function(){function b(b){return function(h){c||(c=!0,b.call(a,h))}}var a=this,c=!1;return{resolve:b(this.v),reject:b(this.f)}};b.prototype.v=function(a){if(a===this)this.f(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof b)this.w(a);else{a:switch(typeof a){case "object":var c=null!=a;break a;case "function":c=!0;break a;default:c=!1}c?this.u(a):this.l(a)}};
b.prototype.u=function(b){var a=void 0;try{a=b.then}catch(k){this.f(k);return}"function"==typeof a?this.A(a,b):this.l(b)};b.prototype.f=function(b){this.m(2,b)};b.prototype.l=function(b){this.m(1,b)};b.prototype.m=function(b,a){if(0!=this.b)throw Error("Cannot settle("+b+", "+a+"): Promise already settled in state"+this.b);this.b=b;this.h=a;this.s()};b.prototype.s=function(){if(null!=this.a){for(var b=0;b<this.a.length;++b)f.b(this.a[b]);this.a=null}};var f=new d;b.prototype.w=function(b){var a=this.c();
b.i(a.resolve,a.reject)};b.prototype.A=function(b,a){var c=this.c();try{b.call(a,c.resolve,c.reject)}catch(m){c.reject(m)}};b.prototype.then=function(a,c){function d(b,a){return"function"==typeof b?function(a){try{e(b(a))}catch(A){f(A)}}:a}var e,f,h=new b(function(b,a){e=b;f=a});this.i(d(a,e),d(c,f));return h};b.prototype.catch=function(b){return this.then(void 0,b)};b.prototype.i=function(b,a){function c(){switch(d.b){case 1:b(d.h);break;case 2:a(d.h);break;default:throw Error("Unexpected state: "+
d.b);}}var d=this;null==this.a?f.b(c):this.a.push(c)};b.resolve=c;b.reject=function(a){return new b(function(b,c){c(a)})};b.race=function(a){return new b(function(b,d){for(var e=l(a),f=e.next();!f.done;f=e.next())c(f.value).i(b,d)})};b.all=function(a){var d=l(a),e=d.next();return e.done?c([]):new b(function(b,a){function f(a){return function(c){h[a]=c;k--;0==k&&b(h)}}var h=[],k=0;do h.push(void 0),k++,c(e.value).i(f(h.length-1),a),e=d.next();while(!e.done)})};return b});
function r(a){function b(b){return a.next(b)}function d(b){return a.throw(b)}return new Promise(function(c,e){function f(a){a.done?c(a.value):Promise.resolve(a.value).then(b,d).then(f,e)}f(a.next())})}
var t=Array.isArray,u=Object.keys,v=Object.prototype.hasOwnProperty,x=function w(a,b){if(a===b)return!0;if(a&&b&&"object"==typeof a&&"object"==typeof b){var c=t(a),e=t(b);if(c&&e){var f=a.length;if(f!=b.length)return!1;for(c=f;0!==c--;)if(!w(a[c],b[c]))return!1;return!0}if(c!=e)return!1;c=a instanceof Date;e=b instanceof Date;if(c!=e)return!1;if(c&&e)return a.getTime()==b.getTime();c=a instanceof RegExp;e=b instanceof RegExp;if(c!=e)return!1;if(c&&e)return a.toString()==b.toString();e=u(a);f=e.length;
if(f!==u(b).length)return!1;for(c=f;0!==c--;)if(!v.call(b,e[c]))return!1;for(c=f;0!==c--;)if(f=e[c],!w(a[f],b[f]))return!1;return!0}return a!==a&&b!==b};function y(a,b,d){b="number"===typeof d?Array(d+1).join(" ")+b:b;a.a.push(b)}function z(a){return(a?a:"").split("\n").map((b)=>Array(7).join(" ")+b).join("\n")}
class B{constructor(){this.a=[]}start(){y(this,"TAP version 13")}label(a){y(this,"# "+a)}test(a){y(this,`${a.j?"ok":"not ok"} ${a.id} ${a.description}`)}error(a){y(this,"---",2);a instanceof Error?(y(this,`name: ${a.name}`,4),y(this,`message: ${a.message}`,4),y(this,`stack: |-\n${z(a.stack)}`,4)):y(this,`error: ${JSON.stringify(a)}`,4);y(this,"...",2)}flush(){console.log(this.a.join("\n"));this.a=[]}}function C(a,b,d){b&&++a.j;a.g&&a.g.test({description:d?d:"",id:++a.a,j:b})}
class D{constructor(a){this.a=this.o=this.j=0;this.f=[];this.g=a;this.context={B:(b,a,c)=>C(this,x(b,a),c),C:(b)=>C(this,!1,b),D:(b,a,c)=>C(this,!x(b,a),c),F:(b)=>C(this,!0,b),test:(b,a,c)=>this.test(b,a,c)}}test(a,b,d){this.c&&!this.c.test(a)||this.b&&this.b.test(a)||this.f.push(()=>{const c=this;return r(function*(){c.g&&c.g.label(a);try{d&&"number"===typeof d.timeout?yield Promise.race([b(c.context),new Promise((a,b)=>{setTimeout(()=>b(Error("Timeout")),d.timeout)})]):yield b(c.context)}catch(e){++c.o,
c.g&&c.g.error(e)}}())})}}var E=new D(new B);const F=(a,b)=>{E.test(a,b)};"undefined"!==typeof window&&(window.Typtap=D,window.Tap=B,window.test=F);}).call(this);
